<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>The Proto-Nucleic-Acid Builder (pNAB): Examples</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">The Proto-Nucleic-Acid Builder (pNAB)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">index</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Examples </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="GUI_examples"></a>
The Graphical User Interface</h1>
<p>The graphical user interface (<a href="https://mybinder.org/v2/gh/alenaizan/pnab/master?urlpath=%2Fapps%2Fbinder/driver.ipynb">here</a>) contains three examples for RNA, DNA, and the hexad systems. You can switch between these three examples using the <em>Input</em> <em>File</em> option. You can run these examples as they are or you can use them as starting points for customizing your options. Bring the mouse pointer to the question marks <em></em>? in front of each option to get some explanation of the option.</p>
<p>After clicking on Run, the program will use the specified options for running. The time required to complete the run depends on the algorithm. After it finishes, the program will display all the accepted candidates and their properties.</p>
 <style>div.image img[src="output.png"]{width:1000px;}</style>  <div class="image">
<img src="output.png" alt="output.png"/>
<div class="caption">
Example Results</div></div>
<p> The results are automatically downloaded as a zip file. Additionally, the output can be downloaded manually by clicking on <em>Download</em> <em>Output</em>. Note that downloading the output is only useful when the program is run in the cloud. When it is run locally the output files are written in the folder where the Jupyter notebook was started.</p>
<p>The dropdown list contains all the accepted candidates ordered by the the total energy. The output data are the distance between between one terminal atom of the backbone and the periodic image of the other terminal atom in the adjacent backbone, the energy of the new bond and the new angles formed between two nucleotides, the energy of all rotatable bonds in the backbone, the van der Waals energy, and the total energy. Note that these six terms are correspond to distance and energy thresholds defined in the input options. Additionally, the output data include the energy of fixed rotatable bonds (zero if none is specified) and the root mean-squared displacement (RMSD) between the backbone atoms of the different conformers. The RMSD is between a given conformer and the lowest energy conformer of the same helical configuration.</p>
<p>The green mark indicates that the sum of the bond, angle, torsion, and van der Waals energies is less than 2 kcal/mol, thus indicating that there is a low energetic penalty from adopting the backbone conformation. If the sum of the energies between 2 and 5 kcal/mol, a yellow mark is displayed. Otherwise, a red mark is shown.</p>
<h1><a class="anchor" id="more"></a>
Additional Examples</h1>
<p>The graphical user interface is essentially a tool for specifying the input options and visualizing the results. However, the functionalities of the program can also be accessed through python scripts.</p>
<h2><a class="anchor" id="input"></a>
Basic Structue of the Input File</h2>
<p>Here, we show the content of an example options file, which can be written by a text editor to specify the options. Input files can also be generated using the graphical user interface.</p>
<pre class="fragment">Backbone:
  file_path: rna_bb.pdb
  interconnects: # Backbone to backbone connection
  - 10
  - 1 
  linker: # Backbone to base connection
  - 13
  - 14
</pre><p>This section specifies the backbone structure. It gives a path to the file containing the three-dimensional structure of the backbone. By default, the program first looks for a file in the current working directory. If it does not find it, it will look for it in the program library. If it does not find it there, it will raise an error. The section also gives the indices of the atoms that connect the backbone to the nucleobase as well as the indices of the atoms that connect backbones together.</p>
<p>An optional entry in this section is specifying fixed rotatable bonds. This can be specified as: </p>
<pre class="fragment">  fixed_bonds:
  - - 1
    - 2
  - - 4
    - 10
</pre><p> This specifies that the dihedral angle specified by atom indices 1 and 2 and the dihedral angle specified by atom indices 4 and 10 will be fixed during the conformation search.</p>
<pre class="fragment">HelicalParameters:
  inclination:
  - 22.9 # Initial point in the range
  - 22.9 # Final point in the range
  - 1 # Number of configrations
  h_rise:
  - 2.53
  - 2.53
  - 1 
  tip:
  - 0.08 
  - 0.08 
  - 1 
  h_twist:
  - 32.39
  - 32.39
  - 1 
  x_displacement:
  - -4.54
  - -4.54
  - 1 
  y_displacement:
  - -0.02
  - -0.02
  - 1 
</pre><p> This section specifies the helical parameters. The first value is the beginning of the range, the second value is the end of the range, and the third value is the number of configurations in the range. If you want a specific single value, simply specify the same value for both the beginning and the end of the interval.</p>
<p>Note that for hexad geometries, only the rise and the twist are defined. Therefore, the ranges for other entries must be set to zero or removed altogether from the input file.</p>
<pre class="fragment">RuntimeParameters:
  seed: 0 # Seed for the random number generator
  search_algorithm: "weighted monte carlo search" # Search algorithm
  num_steps: 10000000 # Number of steps for backbone dihedral search
  weighting_temperature: 298.0 # Temperature used in the weighting procedure for dihedral angles
  monte_carlo_temperature: 298.0 # Temperature used in the Monte Carlo procedure
  max_distance: 0.05 # Maximum distance between atom linkers in backbone
  ff_type: GAFF # Force field type
  energy_filter:
  - 3.0 # Angle energy involving newly formed backbone bonds
  - 3.0 # Bond energy involving newly formed backbone bonds
  - 10.0 # Total torsional energy of rotatable bonds
  - 0.0 # Total van der Waals energy
  - 10000000000.0 # Total Energy of the system
  is_double_stranded: false # Whether to generate a duplex
  strand: CGAUUUAGCG # Sequence of base names
</pre><p>This section specifies the runtime parameters for the program. Other search algorithms can be specified as follows: </p>
<pre class="fragment">  search_algorithm: "systematic search"
  dihedral_step: 2
</pre><pre class="fragment">  search_algorithm: "monte carlo search"
  num_steps: 10000000
  monte_carlo_temperature: 298.0
</pre><pre class="fragment">  search_algorithm: "random search"
  num_steps: 10000000
</pre><pre class="fragment">  search_algorithm: "weighted random search"
  num_steps: 10000000
  weighting_temperature: 298.0
</pre><pre class="fragment">  search_algorithm: "genetic algorithm search"
  num_steps: 1000
  population_size: 1000
  mutation_rate: 0.75
  crossover_rate: 0.75
</pre><p>The example above shows how to build single-stranded RNA. To build a duplex, write: </p>
<pre class="fragment">  is_double_stranded: true
</pre><p>To build a hexad, </p>
<pre class="fragment">  is_hexad: true
  strand_orientation:
  - true
  - true
  - true
  - true
  - true
  - true
</pre><p> The <em>strand_orientation</em> option allows you to build any cobmination of parallel and anti-parallel strands by setting the values to <em>true</em> or <em>false</em> </p>
<h2><a class="anchor" id="bases"></a>
Adding Bases Not Defined in The Library</h2>
<p>The program can build structures with arbitrary nucleobases. The key problem with defining a new nucleobase is making sure that the provided geometry of the nucleobase is in the correct standard frame of reference. Otherwise, the helical parameters will be ill-defined. The additional bases can be defined in the graphical user interface or by editing the input file.</p>
<p>The program has a library of predefined nueleobases. They include adenine, guanine, cytosine, thymine, and uracil. Additionally, there are two proto-nucleobases that are used for building the hexads, namely triaminopyrimidine and cyanuric acid. To define other nucleobases, add the following entries to the input file: </p>
<pre class="fragment">Base modified_adenine:
  code: AD2 # Three letter PDB code
  file_path: modified_adenine.pdb # Path to the 3D structure of the nucleobase
  linker: # Indices of the vector forming the bond between the nucleobase and the backbone
  - 5 
  - 11
  name: Q # One-letter name of the base
  pair_name: T # One-letter name of the pairing base
</pre><p>These lines will add the nucleobase <em>modified_adenine</em> to the library of available nucleobases. For the name of the base, you must not use any of the names already used in the library. Otherwise, your new base might be overwritten. The reserved names are the following: <em>A</em>, <em>G</em>, <em>C</em>, <em>T</em>, <em>U</em>, <em>X</em>, and <em>Y</em>. These names are case-insensitive.</p>
<p>Now that you defined a new nucleobase, you can use its name when you specify the strand: </p>
<pre class="fragment">  strand: CGCQUQTGQG
</pre><p>You can define additional nucleobases in the same way.</p>
<h2><a class="anchor" id="lib"></a>
Adding Files to the Library</h2>
<p>The library of the program is in the folder <em>data</em> in the package folder. The library contains three example files and the coordinates for the defined bases and backbones. You can add additional files there to make them accessible wherever you run your Jupyter notebook or python script. To add other nucleobases to the library, edit the <em>bases_library.yaml</em> files.</p>
<h2><a class="anchor" id="script_example"></a>
Python Script</h2>
<p>The minimal input to run the program as a python script is this: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">import</span> pnab</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;run = pnab.pNAB(<span class="stringliteral">&#39;RNA.yaml&#39;</span>)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;run.run()</div>
</div><!-- fragment --><p>By default, the program first looks for the file <em>RNA.yaml</em> in the current working directory. If it does not find it, it will look for it in the program library. If it does not find it there, it will raise an error. This creates an instance of the <a class="el" href="classdriver_1_1pNAB.html" title="The proto-Nucleic Acid Builder main python class. ">driver.pNAB</a> class, given the options specified in the input file, and runs the program.</p>
<p>To access the options programmatically, you can use the <em>options</em> attribute: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;print(run.options)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;run.options[<span class="stringliteral">&#39;RuntimeParameters&#39;</span>][<span class="stringliteral">&#39;search_algorithm&#39;</span>] = <span class="stringliteral">&#39;monte carlo search&#39;</span></div>
</div><!-- fragment --><p> This attribute is a dictionary of all the defined options, and it can be changed in the script.</p>
<p>After running the program, the instance stores all the results in the <em>results</em> attribute. </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;print(run.results)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;print(run.header)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;print(run.prefix)</div>
</div><!-- fragment --><p> This is a numpy array containing the information about the accepted nucleic acid candidates, that is the candidates that satisfied the distance and energy criteria. The columns in the array are defined accroding to the corresponding entry in the <em>header</em> attribute. The first column in the results contain the prefix value. This is an integer that indicates the sequence of the helical configuration. This parameter is useful when you run a range of values for the helical parameters, where each helical configuration would have a different prefix. The <em>prefix</em> attribute is a dictionary whose keys are strings of the sequence of integers and whose values are strings specifying the corresponding helical configurations. </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;print(run.prefix[<span class="stringliteral">&#39;1&#39;</span>])</div>
</div><!-- fragment --><p>When multiple helical configurations are defined, e.g. by giving a range of values for the twist angle and asking for 5 configurations, the program runs these different helical configurations in parallel. The number of calculations that can be run in parallel depends on the available processors in the computer. By default, the program uses all available CPUs for parallel calculations. To use a different number, you can pass a keyword argumen to the <em>run</em> function: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;run.run(number_of_cpus=1)</div>
</div><!-- fragment --><p>Additionally, the program prints a progress report to the screen by default. If you do not want the progress report, type: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;run.run(verbose=<span class="keyword">False</span>)</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
