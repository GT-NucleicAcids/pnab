<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>The Proto-Nucleic-Acid Builder (pNAB): Advanced Manual</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">The Proto-Nucleic-Acid Builder (pNAB)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">index</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Advanced Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="compiling"></a>
Compiling and Testing the Package</h1>
<p>Clone the GitHub repository at <a href="https://github.com/alenaizan/pnab">https://github.com/alenaizan/pnab</a>. And compile the package. All the dependcies can be satisfied through conda. </p>
<div class="fragment"><div class="line">conda install -c conda-forge python numpy cmake openbabel eigen pybind11 pyyaml nglview</div>
</div><!-- fragment --><p> The C++ compiler in linux can also be installed using Conda. </p>
<div class="fragment"><div class="line">conda install -c conda-forge gcc_linux-64 gxx_linux-64</div>
</div><!-- fragment --><p> The code has been tested using the gcc 7.3 compiler in Linux and the clang 8.0 compiler in Mac.</p>
<p>The code uses the pytest package for testing. To test that the code works, first install pytest: </p>
<div class="fragment"><div class="line">conda install pytest</div>
</div><!-- fragment --><p>Then, execute: </p>
<div class="fragment"><div class="line">python -c <span class="stringliteral">&quot;import pnab; pnab.test()&quot;</span></div>
</div><!-- fragment --><h1><a class="anchor" id="pybind11"></a>
Accessing the C++ Classes through Python</h1>
<p>All the code for manipulating the molecule and computing the energies is written in C++. The main C++ classes that are used for defining the options can be accessed in python. For most cases, it is sufficient to write an input file and call the program using this syntax: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">import</span> pnab</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;run = pnab.pNAB(<span class="stringliteral">&#39;RNA.yaml&#39;</span>)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;run.run()</div>
</div><!-- fragment --><p>The advantage of this approach is that it performs basic validation of the user defined options. Additionally, for runs with multiple helical configurations, the independent configurations can be run in parallel using the <em>multiprocessing</em> library. This is managed internally by the python program. However, if the user wants to access the C++ classes directly through python, then this can be performed as follows:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">from</span> pnab <span class="keyword">import</span> bind</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;backbone = bind.Backbone()</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;backbone.file_path = <span class="stringliteral">&#39;rna_bb.pdb&#39;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;backbone.interconnects = [10, 1]</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;backbone.linker = [13, 14]</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;base = bind.Base()</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;base.file_path = <span class="stringliteral">&#39;adenine.pdb&#39;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;base.code = <span class="stringliteral">&#39;ADE&#39;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;base.linker = [5, 11]</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;base.name = <span class="stringliteral">&#39;Adenine&#39;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;base.pair_name = <span class="stringliteral">&#39;Uracil&#39;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;bases = [base]</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;hp = bind.HelicalParameters()</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;hp.h_twist = 32.39</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;hp.h_rise = 2.53</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;hp.inclination = 22.9</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;hp.tip = 0.08</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;hp.x_displacement = -4.54</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;hp.y_displacement = -0.02</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;rp = bind.RuntimeParameters()</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;rp.search_algorithm = <span class="stringliteral">&#39;weighted random search&#39;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;rp.num_steps = 1000000</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;rp.ff_type = <span class="stringliteral">&#39;GAFF&#39;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;rp.energy_filter = [10000.0, 10000.0, 10000.0, 10000.0]</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;rp.max_distance = 0.05</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;rp.strand = [<span class="stringliteral">&#39;Adenine&#39;</span>]*5</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;output = bind.run(rp, backbone, bases, hp, <span class="stringliteral">&#39;test&#39;</span>)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;print(output)</div>
</div><!-- fragment --><p>The output from the run is a string containing the data in CSV format.</p>
<p>The C++ classes exposed to python are only for defining options and running the program. The other classes can be accessed through the C++ code. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
